# 챗노트 테스트 가이드

## 목차
1. [테스트 환경 개요](#1-테스트-환경-개요)
2. [MCP 테스트 (PlayMCP)](#2-mcp-테스트-playmcp)
3. [Skill 테스트 (카카오 챗봇)](#3-skill-테스트-카카오-챗봇)
4. [테스트 시나리오](#4-테스트-시나리오)
5. [현재 기능 현황](#5-현재-기능-현황)
6. [Skill 확장 계획](#6-skill-확장-계획)

---

## 1. 테스트 환경 개요

### 배포 URL
| 구분 | URL | 용도 |
|------|-----|------|
| Vercel 배포 | `https://memomate-mcp.vercel.app` | 서버 호스팅 |
| MCP 엔드포인트 | `https://memomate-mcp.vercel.app/mcp` | MCP 프로토콜 |
| Skill 엔드포인트 | `https://memomate-mcp.vercel.app/skill` | 카카오 스킬 |

### 관리 페이지
| 플랫폼 | URL | 용도 |
|--------|-----|------|
| PlayMCP | https://playmcp.kakao.com | MCP 등록/테스트 |
| 카카오 챗봇 빌더 | https://chatbot.kakao.com | 스킬 설정/봇 관리 |
| 카카오 채널 채팅 | https://pf.kakao.com/_lwxfgn/chat | 실제 채팅 테스트 |
| Vercel 대시보드 | https://vercel.com/dashboard | 배포/로그 확인 |

---

## 2. MCP 테스트 (PlayMCP)

### 2.1 테스트 접속
1. https://playmcp.kakao.com 접속
2. "AI 채팅" 클릭
3. 좌측 Toolbox에서 "챗노트" 확인 (Tools 8, Online)

### 2.2 MCP 도구 목록 (8개)
| 도구 | 설명 | 상태 |
|------|------|------|
| `add_memo` | 메모 저장 (URL 메타데이터 자동 추출) | ✅ 완료 |
| `list_memos` | 메모 목록 조회 | ✅ 완료 |
| `search_memos` | 메모 검색 | ✅ 완료 |
| `delete_memo` | 메모 삭제 | ✅ 완료 |
| `get_summary` | 기간별/카테고리별 정리 | ✅ 완료 |
| `get_stats` | 통계 조회 | ✅ 완료 |
| `get_reminders` | 리마인더 목록 | ✅ 완료 |
| `get_categories` | 카테고리 목록 | ✅ 완료 |

### 2.3 MCP 테스트 방법
```
1. PlayMCP AI 채팅 접속
2. 챗노트 도구 활성화 확인
3. 자연어로 요청 입력
4. AI가 적절한 도구 호출 확인
5. 응답 결과 검증
```

### 2.4 MCP 테스트 완료 항목 (2025-01-03)
- [x] YouTube URL 메타데이터 추출
  - 입력: `https://www.youtube.com/watch?v=dQw4w9WgXcQ`
  - 결과: 제목 "Rick Astley - Never Gonna Give You Up", 사이트 "YouTube", 썸네일 저장
- [x] Velog 블로그 URL 메타데이터 추출
  - 입력: `https://velog.io/@velopert/react-hooks`
  - 결과: 카테고리 "읽을거리", 썸네일 저장
- [x] 자동 저장 (확인 다이얼로그 없음)

---

## 3. Skill 테스트 (카카오 챗봇)

### 3.1 테스트 방법 2가지

#### 방법 A: 챗봇 빌더 테스트 (웹)
1. https://chatbot.kakao.com 접속
2. 챗노트 봇 선택
3. 우측 상단 "봇 테스트" 클릭
4. 메시지 입력 후 응답 확인

**주의**: 스킬 타임아웃 에러 발생 가능 (`[THRUST] skill timeout`)

#### 방법 B: 카카오톡 실제 채팅 (권장)
1. https://pf.kakao.com/_lwxfgn/chat 접속
2. 카카오톡 앱으로 연결됨
3. 실제 챗봇과 대화 테스트

### 3.2 Skill 현재 상태
| 기능 | 상태 | 비고 |
|------|------|------|
| 메모 저장 | ✅ | UTF-8 인코딩 수정 완료 |
| 메모 정리 | ✅ | 오늘/어제/이번주 등 |
| 메모 검색 | ✅ | 키워드 검색 |
| 메모 삭제 | ✅ | 키워드 기반 삭제 |
| 통계 조회 | ✅ | 카테고리별 통계 |
| 리마인더 | ✅ | 알림 목록 |

### 3.3 Skill 인코딩 수정 이력
```python
# api/skill.py 161번째 줄
# 수정 전: body = await request.json()
# 수정 후:
raw_body = await request.body()
body_text = raw_body.decode('utf-8', errors='replace')
body = json.loads(body_text)
```

---

## 4. 테스트 시나리오

### 4.1 URL 메모 저장 테스트
```
테스트 URL 목록:
1. YouTube: https://www.youtube.com/watch?v=dQw4w9WgXcQ
2. Velog: https://velog.io/@velopert/react-hooks
3. 네이버 블로그: https://blog.naver.com/example
4. 쿠팡: https://www.coupang.com/...
5. 인스타그램: https://www.instagram.com/p/...

예상 결과:
- OG 태그 추출 (제목, 설명, 이미지)
- 플랫폼 자동 감지
- 카테고리 자동 분류
- 썸네일 저장
```

### 4.2 텍스트 메모 저장 테스트
```
테스트 입력:
1. "내일 3시 회의" → 할일 카테고리
2. "맛있는 파스타집 발견" → 맛집 카테고리
3. "아이디어: 앱 만들기" → 아이디어 카테고리

예상 결과:
- AI 분류로 카테고리 자동 지정
- 자동 저장 (확인 없이)
```

### 4.3 정리/요약 테스트
```
테스트 명령:
1. "오늘 정리" → 오늘 저장한 메모 요약
2. "이번주 정리" → 이번주 메모 요약
3. "영상 정리" → 영상 카테고리만 정리
4. "맛집 정리" → 맛집 카테고리만 정리

예상 결과:
- 기간/카테고리별 필터링
- 이모지와 함께 보기 좋게 정리
```

### 4.4 검색/삭제 테스트
```
테스트 명령:
1. "유튜브 검색" → 유튜브 관련 메모 검색
2. "삭제 유튜브" → 유튜브 관련 메모 삭제

예상 결과:
- 키워드 매칭
- 삭제 확인 메시지
```

---

## 5. 현재 기능 현황

### 5.1 MCP vs Skill 비교
| 기능 | MCP | Skill |
|------|-----|-------|
| 메모 저장 | ✅ | ✅ |
| URL 메타데이터 | ✅ (완전) | ⚠️ (제한적) |
| AI 분류 | ✅ | ✅ |
| 정리/요약 | ✅ | ✅ |
| 검색 | ✅ | ✅ |
| 삭제 | ✅ | ✅ |
| 통계 | ✅ | ✅ |
| 리마인더 | ✅ | ✅ |

### 5.2 지원 플랫폼 (메타데이터 추출)
| 카테고리 | 플랫폼 |
|----------|--------|
| 영상 | YouTube, Instagram, TikTok, Netflix |
| 음악 | Spotify, Melon, Apple Music, SoundCloud |
| 블로그 | 네이버 블로그, Tistory, Velog, Brunch, Medium |
| 쇼핑 | 쿠팡, 무신사, 지그재그 |
| 여행 | Airbnb, Booking, 야놀자, 여기어때 |
| 맛집 | 카카오맵, 네이버맵, 망고플레이트 |
| 학습 | 인프런, Udemy, Coursera, Class101 |

---

## 6. Skill 확장 계획

### 6.1 추가 예정 기능
| 기능 | 우선순위 | 상태 |
|------|----------|------|
| 카카오톡 공유하기 버튼 | 높음 | 계획 |
| 이미지 카드 응답 | 높음 | 계획 |
| 리마인더 알림 발송 | 중간 | 계획 |
| 메모 수정 기능 | 중간 | 계획 |
| 태그 기반 검색 | 낮음 | 계획 |

### 6.2 응답 형식 개선
```
현재: 텍스트 응답
목표: 카카오톡 카드형 응답 (썸네일 + 버튼)

예시:
┌─────────────────────────┐
│ 🖼 [썸네일 이미지]       │
├─────────────────────────┤
│ 📺 Rick Astley - Never  │
│    Gonna Give You Up    │
│ 📍 YouTube              │
├─────────────────────────┤
│ [바로가기] [삭제] [공유] │
└─────────────────────────┘
```

### 6.3 Skill 코드 구조 (참고)
```
api/
├── skill.py          # 카카오 스킬 핸들러
├── mcp_server.py     # MCP 서버

lib/
├── classifier.py     # AI 의도 분류
├── metadata.py       # URL 메타데이터 추출
├── storage.py        # Upstash Redis 저장소
├── summarizer.py     # 메모 정리/요약
```

---

## 7. 트러블슈팅

### 7.1 자주 발생하는 에러

#### UTF-8 인코딩 에러
```
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc5
```
**해결**: `request.body().decode('utf-8', errors='replace')` 사용

#### Skill 타임아웃
```
[THRUST] skill timeout
```
**해결**: 응답 시간 30초 이내로 최적화, Cold Start 최소화

#### OpenAI API 에러
```
[Classifier] API Error: 401
```
**해결**: Vercel 환경 변수 `OPENAI_API_KEY` 확인

### 7.2 로그 확인 방법
```bash
# Vercel 로그 실시간 확인
vercel logs memomate-mcp.vercel.app --follow
```

---

## 8. 체크리스트

### 배포 전 체크
- [ ] 로컬 테스트 완료
- [ ] 환경 변수 설정 확인
- [ ] Vercel 배포 성공
- [ ] MCP 엔드포인트 응답 확인
- [ ] Skill 엔드포인트 응답 확인

### MCP 테스트 체크
- [x] PlayMCP에서 챗노트 도구 확인
- [x] add_memo URL 메타데이터 추출
- [x] 자동 저장 동작 확인
- [ ] 모든 8개 도구 테스트

### Skill 테스트 체크
- [ ] 카카오톡 채팅 연결 확인
- [ ] 메모 저장 테스트
- [ ] 정리 명령 테스트
- [ ] 검색/삭제 테스트
- [ ] 통계 조회 테스트

---

## 9. 참고 링크

### 공식 문서
- [PlayMCP 가이드](https://playmcp.kakao.com)
- [카카오 챗봇 빌더](https://chatbot.kakao.com)
- [카카오 비즈니스](https://business.kakao.com)

### 프로젝트 관리
- 카카오 채널 채팅: https://pf.kakao.com/_lwxfgn/chat
- 봇 관리: https://chatbot.kakao.com/bot/6957875684dcee6380090caa/publish

---

*마지막 업데이트: 2025-01-03*
